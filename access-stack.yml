consul:
  image: jfisbein/docker-images:consul-server-ecs
  ports:
    - "8300:8300"
    - "8301:8301"
    - "8301:8301/udp"
    - "8302:8302"
    - "8302:8302/udp"
    - "8400:8400"
    - "8500:8500"
  command: -data-dir=/tmp -bootstrap-expect=2 -rejoin -atlas=jfisbein/infrastructure -atlas-join -atlas-token=sto6stWSLDGjhA.atlasv1.IrfSoRCVKvNYzNYQl5Bmt96CSiMjnActO8tB7SooePzv41Ox5zYa34Wwz1Rj7M6qyFA -log-level=debug -ui-dir=/ui
  target_num_containers: 2
  deployment_strategy: high_availability

devicemodule:
  image: jfisbein/fon-poc:devicemodule
  links:
    - consul
  deployment_strategy: high_availability
  environment:
    CONSUL_HOST: consul

serviceaaa:
  image: jfisbein/fon-poc:serviceaaa
  links:
    - consul
  deployment_strategy: high_availability
  environment:
    CONSUL_HOST: consul

jcp:
  image: jfisbein/fon-poc:jcp
  links:
    - devicemodule
    - serviceaaa
    - consul
  ports:
    - "8080:80"
  deployment_strategy: high_availability
  environment:
    CONSUL_HOST: consul
    TOMCAT_PASS: fonfonfon
